import{s as M,g as x,a as S}from"./getDataSources-eb2db877.js";const I=({name:s,basemapId:r})=>{const o=crypto.randomUUID(),d=x,e={id:o,name:s,basemapId:r,options:{center:[29,41],zoom:9,pitch:0,bearing:0,interactive:!0},sources:[]};return d.push(e),M(d),E(),window.location.href=`./maps/?mapId=${o}`,o},T=async s=>new Promise((r,o)=>{const d=new FileReader;d.onload=e=>r(JSON.parse(e.target.result)),d.onerror=e=>o(e),d.readAsText(s)}),k=async({name:s,url:r,file:o,type:d})=>{const e=crypto.randomUUID(),t=S();let n=null;d==="local-file"&&(n=await T(o));const i={id:e,name:s,url:r,file:n,type:d};t.push(i),localStorage.setItem("dataSources",JSON.stringify(t)),C()},B=()=>[{name:"Colorful",id:"colorful",description:"A colorful map which is each country has different color"},{name:"Open Street Map (OSM)",id:"openstreetmap",description:"A map which is provided by Open Street Map"},{name:"Mapbox Outdoors",id:"mapbox-outdoors",description:"Mapbox Outdoors"},{name:"Mapbox Navigation Day",id:"mapbox-navigation-day",description:"Mapbox Navigation Day"},{name:"Blank",id:"blank",description:"A blank map"}],H=()=>{localStorage.getItem("maps")||localStorage.setItem("maps",JSON.stringify([])),localStorage.getItem("dataSources")||localStorage.setItem("dataSources",JSON.stringify([]))},h=()=>{document.getElementById("modal").remove(),document.querySelector("body").classList.remove("overflow-hidden")},q=()=>{const s=B();document.querySelector("body").classList.add("overflow-hidden");const o=document.createElement("div");o.innerHTML=`
  <div
    id="modal"
    class="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex"
  >
    <div
      id="modal-inner"
      class="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto"
    >
      <div class="flex justify-between items-center font-medium">
        <h2 id="h2-modal-title">Create Map</h2>
        <button id="btn-modal-close">&#10005;</button>
      </div>
          <div class="w-full">
            <div class="text-gray-400 text-xs w-full mb-1">* Required</div>
            <input
              placeholder="Map name"
              class="w-full border border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2"
              type="text"
              name="map-name"
              id="input-studio-map-name"
            />
          </div>
          <div>
            <h4 class="text-sm">Select basemap</h4>
            <ul id="list-studio-basemaps"></ul>
          </div>
    
      <button
        id="btn-studio-create-map-data"
        class="w-full bg-red-500 text-white py-2 rounded-md"
      >
        Submit
      </button>
    </div>
  </div>`.trim(),document.body.appendChild(o.firstChild);const d=document.getElementById("list-studio-basemaps");s.forEach((a,m)=>{const l=document.createElement("li");l.dataset.basemapId=a.id,l.ariaChecked=!1,l.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",m===0&&(l.ariaChecked=!0,l.classList.add("border"),l.classList.add("border-red-500")),l.addEventListener("click",()=>{d.childNodes.forEach(p=>{p.ariaChecked=!1,p.classList.remove("border"),p.classList.remove("border-red-500")}),l.ariaChecked=!0,l.classList.add("border"),l.classList.add("border-red-500"),console.log("clicked")});const f=document.createElement("div");f.className="w-6 h-6 bg-gray-300 rounded-full mr-2",l.appendChild(f);const c=document.createElement("div");c.className="flex flex-col",l.appendChild(c);const b=document.createElement("h3");b.className="font-semibold",b.innerHTML=a.name,c.appendChild(b);const u=document.createElement("p");u.className="text-xs text-gray-500",u.innerHTML=a.description,c.appendChild(u),d.appendChild(l)});const e=document.getElementById("input-studio-map-name");e.addEventListener("input",()=>{e.value!==""?e.removeAttribute("required"):e.setAttribute("required",!0)}),document.getElementById("btn-studio-create-map-data").addEventListener("click",()=>{if(e.value===""){e.setAttribute("required",!0);return}const a=d.querySelector("[aria-checked=true]").dataset.basemapId;I({name:e.value,basemapId:a}),h()});const n=document.getElementById("modal");n.addEventListener("click",a=>{a.target===n&&h()}),document.getElementById("btn-modal-close").addEventListener("click",()=>{h()})},L={newSourceType:null},D=()=>L.newSourceType,A=s=>L.newSourceType=s,N=({tabID:s,tabContent:r=null})=>{switch(r||(r=document.getElementById("tab-content")),A(s),s){case"url":r.innerHTML="";const o=document.createElement("div");o.className="text-gray-400 text-xs w-full mb-1",o.innerText="* Required";const d=document.createElement("input");d.placeholder="Source url",d.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",d.type="text",d.name="source-url",d.id="input-studio-source-url",r.appendChild(o),r.appendChild(d);break;case"local-file":r.innerHTML="";const e=document.createElement("div");e.className="text-gray-400 text-xs w-full mb-1",e.innerText="* Required";const t=document.createElement("input");t.placeholder="Source file",t.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",t.type="file",t.name="source-file",t.id="input-studio-source-file",t.accept=".geojson";const n=document.createElement("div");n.className="text-gray-400 text-xs w-full",n.innerText="Only valid geojson files are supported",r.appendChild(e),r.appendChild(t),r.appendChild(n);break}},g=[{title:"URL",id:"url",active:!0},{title:"Local file",id:"local-file",active:!1}],O=()=>{const s=document.querySelector("body");s.classList.add("overflow-hidden");const r=document.createElement("div");r.id="modal",r.className="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex";const o=document.createElement("div");o.id="modal-inner",o.className="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto";const d=document.createElement("div");d.className="flex justify-between items-center font-medium";const e=document.createElement("h2");e.id="h2-modal-title",e.innerText="Create source";const t=document.createElement("button");t.id="btn-modal-close",t.innerHTML="&#10005;";const n=document.createElement("div");n.className="w-full";const i=document.createElement("div");i.className="text-gray-400 text-xs w-full mb-1",i.innerText="* Required";const a=document.createElement("input");a.placeholder="Source name",a.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",a.type="text",a.name="source-name",a.id="input-studio-source-name";const m=document.createElement("ul");m.className="flex flex-wrap mb-2";const l=document.createElement("div");l.id="tab-content",l.className="w-full h-fit",N({tabID:g.filter(c=>c.active)[0].id,tabContent:l}),g.forEach(c=>{const b=document.createElement("li");b.className="mr-2";const u=document.createElement("button");u.id=`btn-studio-source-type-${c.id}`,u.ariaSelected=c.active,u.className="inline-block px-4 py-2 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 aria-selected:border-blue-300 aria-selected:text-gray-600",u.innerText=c.title,b.appendChild(u),m.appendChild(b),u.addEventListener("click",()=>{u.ariaSelected!=="true"&&(g.forEach(p=>{document.getElementById(`btn-studio-source-type-${p.id}`).setAttribute("aria-selected",!1)}),u.setAttribute("aria-selected",!0),N({tabID:c.id}))})});const f=document.createElement("button");f.id="btn-studio-create-map-data",f.className="w-full bg-red-500 text-white py-2 rounded-md",f.innerText="Submit",n.appendChild(i),n.appendChild(a),n.appendChild(m),n.appendChild(l),d.appendChild(e),d.appendChild(t),o.appendChild(d),o.appendChild(n),o.appendChild(f),r.appendChild(o),s.appendChild(r),a.addEventListener("input",()=>{a.value!==""?a.removeAttribute("required"):a.setAttribute("required",!0)}),f.addEventListener("click",()=>{if(a.value===""){a.setAttribute("required",!0);return}let c=null,b=null;const u=D();if(u==="url"){const p=document.getElementById("input-studio-source-url");if(p.value===""){p.setAttribute("required",!0);return}c=p.value}if(u==="local-file"){const p=document.getElementById("input-studio-source-file");if(p.value===""){p.setAttribute("required",!0);return}b=p.files[0]}k({name:a.value,url:c,file:b,type:u}),h()}),r.addEventListener("click",c=>{c.target===r&&h()}),t.addEventListener("click",()=>{h()})},E=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.add("hidden"),s.classList.remove("hidden");const o=x(),d=document.getElementById("list-studio");if(d.innerHTML="",o.length===0){const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const t=document.createElement("div");t.className="flex flex-col",e.appendChild(t);const n=document.createElement("h3");n.className="font-medium",n.innerHTML="No maps found",t.appendChild(n),d.appendChild(e);return}o.forEach(e=>{const t=document.createElement("li");t.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",t.addEventListener("click",()=>{window.location.href=`./maps/?mapId=${e.id}`});const n=document.createElement("div");n.className="w-6 h-6 bg-gray-300 rounded-full mr-2",t.appendChild(n);const i=document.createElement("div");i.className="flex flex-col",t.appendChild(i);const a=document.createElement("h3");a.className="font-semibold",a.innerHTML=e.name,i.appendChild(a);const m=document.createElement("p");m.className="text-xs text-gray-500",m.innerHTML=e.basemapId,i.appendChild(m),d.appendChild(t)})},C=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.remove("hidden"),s.classList.add("hidden");const o=S(),d=document.getElementById("list-studio");if(d.innerHTML="",o.length===0){const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const t=document.createElement("div");t.className="flex flex-col",e.appendChild(t);const n=document.createElement("h3");n.className="font-medium",n.innerHTML="No data sources found",t.appendChild(n),d.appendChild(e);return}o.forEach(e=>{const t=document.createElement("li");t.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",t.addEventListener("click",()=>{console.log("clicked")});const n=document.createElement("div");n.className="w-6 h-6 bg-gray-300 rounded-full mr-2",t.appendChild(n);const i=document.createElement("div");i.className="flex flex-col",t.appendChild(i);const a=document.createElement("h3");a.className="font-semibold",a.innerHTML=e.name,i.appendChild(a);const m=document.createElement("p");m.className="text-xs text-gray-500",m.innerHTML=e.type,i.appendChild(m),d.appendChild(t)})};H();const y=document.getElementById("btn-studio-maps"),v=document.getElementById("btn-studio-data"),w=document.getElementById("h-studio-type");w.innerHTML="Maps";E();y.addEventListener("click",()=>{v.classList.remove("active"),y.classList.add("active"),w.innerHTML="Maps",E()});v.addEventListener("click",()=>{y.classList.remove("active"),v.classList.add("active"),w.innerHTML="Sources",C()});const j=document.getElementById("btn-studio-new-map");j.addEventListener("click",()=>{x().length<5&&q()});const J=document.getElementById("btn-studio-new-data-source");J.addEventListener("click",()=>{S().length<5&&O()});const P=document.getElementById("reset-all");P.addEventListener("click",()=>{localStorage.setItem("maps",JSON.stringify([])),localStorage.setItem("dataSources",JSON.stringify([])),y.click()});
