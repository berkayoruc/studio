import{g as x}from"./getDataSources-40a117c4.js";const C=({name:s,basemapId:o})=>{const r=crypto.randomUUID(),d=localStorage.getItem("maps"),t=JSON.parse(d),e={id:r,name:s,basemapId:o,options:{center:[29,41],zoom:9,pitch:0,bearing:0,interactive:!0},sources:[]};return t.push(e),localStorage.setItem("maps",JSON.stringify(t)),S(),window.location.href=`./maps/?mapId=${r}`,r},M=async s=>new Promise((o,r)=>{const d=new FileReader;d.onload=t=>o(JSON.parse(t.target.result)),d.onerror=t=>r(t),d.readAsText(s)}),I=async({name:s,url:o,file:r,type:d})=>{const t=crypto.randomUUID(),e=x();let n=null;d==="local-file"&&(n=await M(r));const c={id:t,name:s,url:o,file:n,type:d};e.push(c),localStorage.setItem("dataSources",JSON.stringify(e)),L()},T=()=>[{name:"Colorful",id:"colorful",description:"A colorful map which is each country has different color"},{name:"Open Street Map (OSM)",id:"openstreetmap",description:"A map which is provided by Open Street Map"},{name:"Mapbox Outdoors",id:"mapbox-outdoors",description:"Mapbox Outdoors"},{name:"Mapbox Navigation Day",id:"mapbox-navigation-day",description:"Mapbox Navigation Day"},{name:"Blank",id:"blank",description:"A blank map"}],k=()=>{localStorage.getItem("maps")||localStorage.setItem("maps",JSON.stringify([])),localStorage.getItem("dataSources")||localStorage.setItem("dataSources",JSON.stringify([]))},h=()=>{document.getElementById("modal").remove(),document.querySelector("body").classList.remove("overflow-hidden")},B=()=>{const s=T();document.querySelector("body").classList.add("overflow-hidden");const r=document.createElement("div");r.innerHTML=`
  <div
    id="modal"
    class="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex"
  >
    <div
      id="modal-inner"
      class="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto"
    >
      <div class="flex justify-between items-center font-medium">
        <h2 id="h2-modal-title">Create Map</h2>
        <button id="btn-modal-close">&#10005;</button>
      </div>
          <div class="w-full">
            <div class="text-gray-400 text-xs w-full mb-1">* Required</div>
            <input
              placeholder="Map name"
              class="w-full border border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2"
              type="text"
              name="map-name"
              id="input-studio-map-name"
            />
          </div>
          <div>
            <h4 class="text-sm">Select basemap</h4>
            <ul id="list-studio-basemaps"></ul>
          </div>
    
      <button
        id="btn-studio-create-map-data"
        class="w-full bg-red-500 text-white py-2 rounded-md"
      >
        Submit
      </button>
    </div>
  </div>`.trim(),document.body.appendChild(r.firstChild);const d=document.getElementById("list-studio-basemaps");s.forEach((a,m)=>{const l=document.createElement("li");l.dataset.basemapId=a.id,l.ariaChecked=!1,l.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",m===0&&(l.ariaChecked=!0,l.classList.add("border"),l.classList.add("border-red-500")),l.addEventListener("click",()=>{d.childNodes.forEach(p=>{p.ariaChecked=!1,p.classList.remove("border"),p.classList.remove("border-red-500")}),l.ariaChecked=!0,l.classList.add("border"),l.classList.add("border-red-500"),console.log("clicked")});const f=document.createElement("div");f.className="w-6 h-6 bg-gray-300 rounded-full mr-2",l.appendChild(f);const i=document.createElement("div");i.className="flex flex-col",l.appendChild(i);const b=document.createElement("h3");b.className="font-semibold",b.innerHTML=a.name,i.appendChild(b);const u=document.createElement("p");u.className="text-xs text-gray-500",u.innerHTML=a.description,i.appendChild(u),d.appendChild(l)});const t=document.getElementById("input-studio-map-name");t.addEventListener("input",()=>{t.value!==""?t.removeAttribute("required"):t.setAttribute("required",!0)}),document.getElementById("btn-studio-create-map-data").addEventListener("click",()=>{if(t.value===""){t.setAttribute("required",!0);return}const a=d.querySelector("[aria-checked=true]").dataset.basemapId;C({name:t.value,basemapId:a}),h()});const n=document.getElementById("modal");n.addEventListener("click",a=>{a.target===n&&h()}),document.getElementById("btn-modal-close").addEventListener("click",()=>{h()})},N={newSourceType:null},H=()=>N.newSourceType,q=s=>N.newSourceType=s,w=({tabID:s,tabContent:o=null})=>{switch(o||(o=document.getElementById("tab-content")),q(s),s){case"url":o.innerHTML="";const r=document.createElement("div");r.className="text-gray-400 text-xs w-full mb-1",r.innerText="* Required";const d=document.createElement("input");d.placeholder="Source url",d.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",d.type="text",d.name="source-url",d.id="input-studio-source-url",o.appendChild(r),o.appendChild(d);break;case"local-file":o.innerHTML="";const t=document.createElement("div");t.className="text-gray-400 text-xs w-full mb-1",t.innerText="* Required";const e=document.createElement("input");e.placeholder="Source file",e.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",e.type="file",e.name="source-file",e.id="input-studio-source-file",e.accept=".geojson";const n=document.createElement("div");n.className="text-gray-400 text-xs w-full",n.innerText="Only valid geojson files are supported",o.appendChild(t),o.appendChild(e),o.appendChild(n);break}},y=[{title:"URL",id:"url",active:!0},{title:"Local file",id:"local-file",active:!1}],O=()=>{const s=document.querySelector("body");s.classList.add("overflow-hidden");const o=document.createElement("div");o.id="modal",o.className="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex";const r=document.createElement("div");r.id="modal-inner",r.className="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto";const d=document.createElement("div");d.className="flex justify-between items-center font-medium";const t=document.createElement("h2");t.id="h2-modal-title",t.innerText="Create source";const e=document.createElement("button");e.id="btn-modal-close",e.innerHTML="&#10005;";const n=document.createElement("div");n.className="w-full";const c=document.createElement("div");c.className="text-gray-400 text-xs w-full mb-1",c.innerText="* Required";const a=document.createElement("input");a.placeholder="Source name",a.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",a.type="text",a.name="source-name",a.id="input-studio-source-name";const m=document.createElement("ul");m.className="flex flex-wrap mb-2";const l=document.createElement("div");l.id="tab-content",l.className="w-full h-fit",w({tabID:y.filter(i=>i.active)[0].id,tabContent:l}),y.forEach(i=>{const b=document.createElement("li");b.className="mr-2";const u=document.createElement("button");u.id=`btn-studio-source-type-${i.id}`,u.ariaSelected=i.active,u.className="inline-block px-4 py-2 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 aria-selected:border-blue-300 aria-selected:text-gray-600",u.innerText=i.title,b.appendChild(u),m.appendChild(b),u.addEventListener("click",()=>{u.ariaSelected!=="true"&&(y.forEach(p=>{document.getElementById(`btn-studio-source-type-${p.id}`).setAttribute("aria-selected",!1)}),u.setAttribute("aria-selected",!0),w({tabID:i.id}))})});const f=document.createElement("button");f.id="btn-studio-create-map-data",f.className="w-full bg-red-500 text-white py-2 rounded-md",f.innerText="Submit",n.appendChild(c),n.appendChild(a),n.appendChild(m),n.appendChild(l),d.appendChild(t),d.appendChild(e),r.appendChild(d),r.appendChild(n),r.appendChild(f),o.appendChild(r),s.appendChild(o),a.addEventListener("input",()=>{a.value!==""?a.removeAttribute("required"):a.setAttribute("required",!0)}),f.addEventListener("click",()=>{if(a.value===""){a.setAttribute("required",!0);return}let i=null,b=null;const u=H();if(u==="url"){const p=document.getElementById("input-studio-source-url");if(p.value===""){p.setAttribute("required",!0);return}i=p.value}if(u==="local-file"){const p=document.getElementById("input-studio-source-file");if(p.value===""){p.setAttribute("required",!0);return}b=p.files[0]}I({name:a.value,url:i,file:b,type:u}),h()}),o.addEventListener("click",i=>{i.target===o&&h()}),e.addEventListener("click",()=>{h()})},S=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.add("hidden"),s.classList.remove("hidden");const r=localStorage.getItem("maps"),d=JSON.parse(r),t=document.getElementById("list-studio");if(t.innerHTML="",d.length===0){const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const n=document.createElement("div");n.className="flex flex-col",e.appendChild(n);const c=document.createElement("h3");c.className="font-medium",c.innerHTML="No maps found",n.appendChild(c),t.appendChild(e);return}d.forEach(e=>{const n=document.createElement("li");n.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",n.addEventListener("click",()=>{window.location.href=`./maps/?mapId=${e.id}`});const c=document.createElement("div");c.className="w-6 h-6 bg-gray-300 rounded-full mr-2",n.appendChild(c);const a=document.createElement("div");a.className="flex flex-col",n.appendChild(a);const m=document.createElement("h3");m.className="font-semibold",m.innerHTML=e.name,a.appendChild(m);const l=document.createElement("p");l.className="text-xs text-gray-500",l.innerHTML=e.basemapId,a.appendChild(l),t.appendChild(n)})},L=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.remove("hidden"),s.classList.add("hidden");const r=x(),d=document.getElementById("list-studio");if(d.innerHTML="",r.length===0){const t=document.createElement("li");t.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const e=document.createElement("div");e.className="flex flex-col",t.appendChild(e);const n=document.createElement("h3");n.className="font-medium",n.innerHTML="No data sources found",e.appendChild(n),d.appendChild(t);return}r.forEach(t=>{const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",e.addEventListener("click",()=>{console.log("clicked")});const n=document.createElement("div");n.className="w-6 h-6 bg-gray-300 rounded-full mr-2",e.appendChild(n);const c=document.createElement("div");c.className="flex flex-col",e.appendChild(c);const a=document.createElement("h3");a.className="font-semibold",a.innerHTML=t.name,c.appendChild(a);const m=document.createElement("p");m.className="text-xs text-gray-500",m.innerHTML=t.type,c.appendChild(m),d.appendChild(e)})};k();const g=document.getElementById("btn-studio-maps"),v=document.getElementById("btn-studio-data"),E=document.getElementById("h-studio-type");E.innerHTML="Maps";S();g.addEventListener("click",()=>{v.classList.remove("active"),g.classList.add("active"),E.innerHTML="Maps",S()});v.addEventListener("click",()=>{g.classList.remove("active"),v.classList.add("active"),E.innerHTML="Sources",L()});const D=document.getElementById("btn-studio-new-map");D.addEventListener("click",()=>{const s=localStorage.getItem("maps");JSON.parse(s).length<5&&B()});const A=document.getElementById("btn-studio-new-data-source");A.addEventListener("click",()=>{x().length<5&&O()});const J=document.getElementById("reset-all");J.addEventListener("click",()=>{localStorage.setItem("maps",JSON.stringify([])),localStorage.setItem("dataSources",JSON.stringify([])),g.click()});
