import{g,s as M,a as S}from"./getDataSources-eb2db877.js";const k=s=>{localStorage.setItem("dataSources",JSON.stringify(s))},B=({name:s,basemapId:r})=>{const n=crypto.randomUUID(),d=g(),e={id:n,name:s,basemapId:r,options:{center:[29,41],zoom:9,pitch:0,bearing:0,interactive:!0},sources:[]};return d.push(e),M(d),E(),window.location.href=`./maps/?mapId=${n}`,n},H=async s=>new Promise((r,n)=>{const d=new FileReader;d.onload=e=>r(JSON.parse(e.target.result)),d.onerror=e=>n(e),d.readAsText(s)}),q=async({name:s,url:r,file:n,type:d})=>{const e=crypto.randomUUID(),t=S();let o=null;d==="local-file"&&(o=await H(n));const m={id:e,name:s,url:r,file:o,type:d};t.push(m),localStorage.setItem("dataSources",JSON.stringify(t)),w()},D=()=>[{name:"Colorful",id:"colorful",description:"A colorful map which is each country has different color"},{name:"Open Street Map (OSM)",id:"openstreetmap",description:"A map which is provided by Open Street Map"},{name:"Mapbox Outdoors",id:"mapbox-outdoors",description:"Mapbox Outdoors"},{name:"Mapbox Navigation Day",id:"mapbox-navigation-day",description:"Mapbox Navigation Day"},{name:"Blank",id:"blank",description:"A blank map"}],A=()=>{localStorage.getItem("maps")||localStorage.setItem("maps",JSON.stringify([])),localStorage.getItem("dataSources")||localStorage.setItem("dataSources",JSON.stringify([]))},h=()=>{document.getElementById("modal").remove(),document.querySelector("body").classList.remove("overflow-hidden")},O=()=>{const s=D();document.querySelector("body").classList.add("overflow-hidden");const n=document.createElement("div");n.innerHTML=`
  <div
    id="modal"
    class="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex"
  >
    <div
      id="modal-inner"
      class="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto"
    >
      <div class="flex justify-between items-center font-medium">
        <h2 id="h2-modal-title">Create Map</h2>
        <button id="btn-modal-close">&#10005;</button>
      </div>
          <div class="w-full">
            <div class="text-gray-400 text-xs w-full mb-1">* Required</div>
            <input
              placeholder="Map name"
              class="w-full border border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2"
              type="text"
              name="map-name"
              id="input-studio-map-name"
            />
          </div>
          <div>
            <h4 class="text-sm">Select basemap</h4>
            <ul id="list-studio-basemaps"></ul>
          </div>
    
      <button
        id="btn-studio-create-map-data"
        class="w-full bg-red-500 text-white py-2 rounded-md"
      >
        Submit
      </button>
    </div>
  </div>`.trim(),document.body.appendChild(n.firstChild);const d=document.getElementById("list-studio-basemaps");s.forEach((a,p)=>{const i=document.createElement("li");i.dataset.basemapId=a.id,i.ariaChecked=!1,i.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",p===0&&(i.ariaChecked=!0,i.classList.add("border"),i.classList.add("border-red-500")),i.addEventListener("click",()=>{d.childNodes.forEach(l=>{l.ariaChecked=!1,l.classList.remove("border"),l.classList.remove("border-red-500")}),i.ariaChecked=!0,i.classList.add("border"),i.classList.add("border-red-500"),console.log("clicked")});const f=document.createElement("div");f.className="w-6 h-6 bg-gray-300 rounded-full mr-2",i.appendChild(f);const c=document.createElement("div");c.className="flex flex-col",i.appendChild(c);const b=document.createElement("h3");b.className="font-semibold",b.innerHTML=a.name,c.appendChild(b);const u=document.createElement("p");u.className="text-xs text-gray-500",u.innerHTML=a.description,c.appendChild(u),d.appendChild(i)});const e=document.getElementById("input-studio-map-name");e.addEventListener("input",()=>{e.value!==""?e.removeAttribute("required"):e.setAttribute("required",!0)}),document.getElementById("btn-studio-create-map-data").addEventListener("click",()=>{if(e.value===""){e.setAttribute("required",!0);return}const a=d.querySelector("[aria-checked=true]").dataset.basemapId;B({name:e.value,basemapId:a}),h()});const o=document.getElementById("modal");o.addEventListener("click",a=>{a.target===o&&h()}),document.getElementById("btn-modal-close").addEventListener("click",()=>{h()})},I={newSourceType:null},j=()=>I.newSourceType,J=s=>I.newSourceType=s,C=({tabID:s,tabContent:r=null})=>{switch(r||(r=document.getElementById("tab-content")),J(s),s){case"url":r.innerHTML="";const n=document.createElement("div");n.className="text-gray-400 text-xs w-full mb-1",n.innerText="* Required";const d=document.createElement("input");d.placeholder="Source url",d.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",d.type="text",d.name="source-url",d.id="input-studio-source-url",r.appendChild(n),r.appendChild(d);break;case"local-file":r.innerHTML="";const e=document.createElement("div");e.className="text-gray-400 text-xs w-full mb-1",e.innerText="* Required";const t=document.createElement("input");t.placeholder="Source file",t.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",t.type="file",t.name="source-file",t.id="input-studio-source-file",t.accept=".geojson";const o=document.createElement("div");o.className="text-gray-400 text-xs w-full",o.innerText="Only valid geojson files are supported",r.appendChild(e),r.appendChild(t),r.appendChild(o);break}},x=[{title:"URL",id:"url",active:!0},{title:"Local file",id:"local-file",active:!1}],P=()=>{const s=document.querySelector("body");s.classList.add("overflow-hidden");const r=document.createElement("div");r.id="modal",r.className="w-full h-full fixed left-0 right-0 top-0 backdrop-blur-sm bg-gray-800 bg-opacity-25 justify-center items-center flex";const n=document.createElement("div");n.id="modal-inner",n.className="bg-white drop-shadow-xl flex flex-col rounded-lg p-4 gap-4 w-1/2 min-w-[300px] max-h-minus48 overflow-y-auto";const d=document.createElement("div");d.className="flex justify-between items-center font-medium";const e=document.createElement("h2");e.id="h2-modal-title",e.innerText="Create source";const t=document.createElement("button");t.id="btn-modal-close",t.innerHTML="&#10005;";const o=document.createElement("div");o.className="w-full";const m=document.createElement("div");m.className="text-gray-400 text-xs w-full mb-1",m.innerText="* Required";const a=document.createElement("input");a.placeholder="Source name",a.className="w-full border mb-1 border-red-50 rounded-sm focus:outline-none focus:border-red-200 required:border-red-500 placeholder:text-sm placeholder:text-gray-200 p-2",a.type="text",a.name="source-name",a.id="input-studio-source-name";const p=document.createElement("ul");p.className="flex flex-wrap mb-2";const i=document.createElement("div");i.id="tab-content",i.className="w-full h-fit",C({tabID:x.filter(c=>c.active)[0].id,tabContent:i}),x.forEach(c=>{const b=document.createElement("li");b.className="mr-2";const u=document.createElement("button");u.id=`btn-studio-source-type-${c.id}`,u.ariaSelected=c.active,u.className="inline-block px-4 py-2 border-b-2 border-transparent rounded-t-lg hover:text-gray-600 hover:border-gray-300 dark:hover:text-gray-300 aria-selected:border-blue-300 aria-selected:text-gray-600",u.innerText=c.title,b.appendChild(u),p.appendChild(b),u.addEventListener("click",()=>{u.ariaSelected!=="true"&&(x.forEach(l=>{document.getElementById(`btn-studio-source-type-${l.id}`).setAttribute("aria-selected",!1)}),u.setAttribute("aria-selected",!0),C({tabID:c.id}))})});const f=document.createElement("button");f.id="btn-studio-create-map-data",f.className="w-full bg-red-500 text-white py-2 rounded-md",f.innerText="Submit",o.appendChild(m),o.appendChild(a),o.appendChild(p),o.appendChild(i),d.appendChild(e),d.appendChild(t),n.appendChild(d),n.appendChild(o),n.appendChild(f),r.appendChild(n),s.appendChild(r),a.addEventListener("input",()=>{a.value!==""?a.removeAttribute("required"):a.setAttribute("required",!0)}),f.addEventListener("click",()=>{if(a.value===""){a.setAttribute("required",!0);return}let c=null,b=null;const u=j();if(u==="url"){const l=document.getElementById("input-studio-source-url");if(l.value===""){l.setAttribute("required",!0);return}c=l.value}if(u==="local-file"){const l=document.getElementById("input-studio-source-file");if(l.value===""){l.setAttribute("required",!0);return}b=l.files[0]}q({name:a.value,url:c,file:b,type:u}),h()}),r.addEventListener("click",c=>{c.target===r&&h()}),t.addEventListener("click",()=>{h()})},E=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.add("hidden"),s.classList.remove("hidden");const n=g(),d=document.getElementById("list-studio");if(d.innerHTML="",n.length===0){const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const t=document.createElement("div");t.className="flex flex-col",e.appendChild(t);const o=document.createElement("h3");o.className="font-medium",o.innerHTML="No maps found",t.appendChild(o),d.appendChild(e);return}n.forEach(e=>{const t=document.createElement("li");t.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",t.addEventListener("click",()=>{window.location.href=`./maps/?mapId=${e.id}`});const o=document.createElement("div");o.className="w-6 h-6 bg-gray-300 rounded-full mr-2",t.appendChild(o);const m=document.createElement("div");m.className="flex flex-col",t.appendChild(m);const a=document.createElement("h3");a.className="font-semibold",a.innerHTML=e.name,m.appendChild(a);const p=document.createElement("p");p.className="text-xs text-gray-500",p.innerHTML=e.basemapId,m.appendChild(p),d.appendChild(t)})},w=()=>{const s=document.getElementById("btn-studio-new-map");document.getElementById("btn-studio-new-data-source").classList.remove("hidden"),s.classList.add("hidden");const n=S(),d=document.getElementById("list-studio");if(d.innerHTML="",n.length===0){const e=document.createElement("li");e.className="flex justify-start items-center cursor-pointer p-2 rounded-md text-gray-400";const t=document.createElement("div");t.className="flex flex-col",e.appendChild(t);const o=document.createElement("h3");o.className="font-medium",o.innerHTML="No data sources found",t.appendChild(o),d.appendChild(e);return}n.forEach(e=>{const t=document.createElement("li");t.className="flex justify-start items-center cursor-pointer hover:bg-gray-100 hover:text-red-800 p-2 rounded-md",t.addEventListener("click",()=>{console.log("clicked")});const o=document.createElement("div");o.className="w-6 h-6 bg-gray-300 rounded-full mr-2",t.appendChild(o);const m=document.createElement("div");m.className="flex flex-col grow",t.appendChild(m);const a=document.createElement("h3");a.className="font-semibold",a.innerHTML=e.name,m.appendChild(a);const p=document.createElement("p");p.className="text-xs text-gray-500",p.innerHTML=e.type,m.appendChild(p);const i=document.createElement("span");i.className="material-symbols-outlined p-2 border-l border-l-gray-300 text-gray-600 hover:text-red-600",i.innerText="delete",i.addEventListener("click",f=>{f.stopPropagation();const c=n.findIndex(l=>l.id===e.id);n.splice(c,1),k(n),w();const u=g().map(l=>{if(l.sources.includes(e.id)){const L=l.sources.findIndex(T=>T.id===e.id);l.sources.splice(L,1)}return l});M(u)}),t.appendChild(i),d.appendChild(t)})};A();const y=document.getElementById("btn-studio-maps"),v=document.getElementById("btn-studio-data"),N=document.getElementById("h-studio-type");N.innerHTML="Maps";E();y.addEventListener("click",()=>{v.classList.remove("active"),y.classList.add("active"),N.innerHTML="Maps",E()});v.addEventListener("click",()=>{y.classList.remove("active"),v.classList.add("active"),N.innerHTML="Sources",w()});const R=document.getElementById("btn-studio-new-map");R.addEventListener("click",()=>{g().length<5&&O()});const U=document.getElementById("btn-studio-new-data-source");U.addEventListener("click",()=>{S().length<5&&P()});const F=document.getElementById("reset-all");F.addEventListener("click",()=>{localStorage.setItem("maps",JSON.stringify([])),localStorage.setItem("dataSources",JSON.stringify([])),y.click()});
